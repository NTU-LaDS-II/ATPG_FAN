
<a name="readme-top"></a>

<h1 align="center">FAN ATPG</h1>
<div align="center"><small><i>version 2023<br>
Laboratory of Dependable Systems(II), Graduate Institute of Electronics Engineering,  National Taiwan University, Taiwan</small></i></div>
<br>
<div align="center">
  <p>An Automatic Test Pattern Generation Open Source Project</p>
  <p align="center">
    <a href="https://github.com/NTU-LaDS-II/FAN_ATPG/blob/main/ATPG_UserGuide.pdf">
    <strong>User Guide Â»</strong></a>
  </p>
</div>

<details>
  <summary><b>Table Contents</b></summary>
  <ol>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#file-structure">File Structure</a></li>
    <li><a href="#environment-requisites">Environment Requisites</a></li>
    <li><a href="#usage">Usage</a></li>
    <li><a href="#experimental-result">Experimental Result</a></li>
    <li><a href="#revision-history">Revision History</a></li>
    <li><a href="#authors">Authors</a></li>
    <li><a href="#references">References</a></li>
    <li><a href="#contact">Contact</a></li>
    <li><a href="#license">License</a></li>
  </ol>
</details>

## Introduction

This project is an FAN[1] based Automatic Test Pattern Generation (ATPG) and Fault Simulation command line tool.

This project includes the implementation of 
1. Fault Collapsing
2. Parallel Fault Fault Simulation
3. Parallel Pattern Fault Simulation 
4. Automatic Test Pattern Generation
5. Static Test Compression
6. Dynamic Test Compression
7. Writing pattern in different format:
    - STIL : Support Fault Simulation with the commercial tool TetraMAX <br>
    - ASCII : Support Fault Simulation with the commercial tool FastScan <br>
    - .pat : Support Fault Simulation with this tool FAN_ATPG
8. Multiple Fault Orderings <br>
    This is a heuristic we implemented in v2023. It tries a rational number of fault list orderings that differ to one another as much as possible with rational run time. We further compressed the Test Length of the generated pattern set after implementing this heuristic and achieve the <a href="#experimental-result">Experimental Result</a>.

We make this project an open source project in the hope of helping anyone who is learning ATPG. If you have any suggestion for the source code or new features for this project, feel free to fork this repo and create a pull request. Any contribution to this project would be very much appreciated!

We would also be extremely grateful if you star this project!

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## File Structure

- `bin/` : Binary - Store binaries after compilation
- `include/` : Store header files included in and copied from `pkg/` 
- `lib/` : Library - Store library binaries after compilation
- `mod_netlist/`, `netlist/` : Store the benchmark circuits[2]
- `pat/` : Patterns - Store the patterns generated by ATPG
- `pkg/` : Package - All of the source code
  - `common/` : Common Linux command line instructions support
  - `core/` : Main ATPG algorithm and the fault simulation procedure 
  - `fan/` : The ATPG commands and entry point of the program
  - `interface/` : The interface for reading benchmark circuits 
- `rpt/` : Report - Store the report after ATPG or fault simulation 
- `script/` : Scripts for running ATPG and fault simulation 
- `techlib/` : The cell libraries for benchmark circuits
- `utility/` : The utilities files, e.g. convert STIL to .pat
- `ATPG_UserGuide.pdf` : The User Guide
- `copyHeader.sh` : Copy header files from `pkg/` to `include/`
- `*.mk` : Included in other makefiles

<p align="right">(<a href="#readme-top">back to top</a>)</p>


## Environment Requisites

### Prerequisites
* Operating System: *Linux*
* Compiler: *Support std C++11*
* Other tools: *Bison, Lex*

### Requisites Installation
```sh
sudo apt install bison
sudo apt install lex
```
### Check requisites Installation
```sh
bison --version
lex --version
```
<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Usage

### Installation
After the following commands are executed, an executable binary `fan` will be generated under `./bin/opt/`.

1. Clone the repo
    ```sh
    git clone https://github.com/NTU-LaDS-II/FAN_ATPG.git
    ```
2. Change directory
    ```sh
    cd FAN_ATPG/
    ```
3. Compile
    ```sh
    make
    ```

### Clean Installed Files
```sh
make clean
```

### Run ATPG
```sh
./bin/opt/fan -f script/fanScripts/atpg_s27.script
```

### Run Fault Simulation
```sh
./bin/opt/fan -f script/fanScripts/fsim_s27.script
```

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Experimental Result

- Without Dynamic Test Compression

  | Circuits | Fault Coverage (%) | Test Length |
  | :----:   | :----:             | :----:      |
  | s27      | 93.64              | 9           |
  | s208     | 97.43              | 36          |
  | s510     | 99.07              | 65          |
  | s953     | 97.85              | 93          |
  | s1196    | 98.84              | 155         |
  | s1238    | 96.36              | 163         |
  | s5378    | 96.04              | 327         |
  | s9234    | 93.8               | 475         |
  | s15850   | 94.17              | 583         |
  | s35932   | 87.3               | 512         |
  | s38417   | 95.65              | 1562        |
  | s38584   | 93.26              | 1177        |
<br>

- **With Dynamic Test Compression**

  | Circuits | Fault Coverage (%) | Test Length |
  | :----:   | :----:             | :----:      |
  | s27      | 94.55              | 5           |
  | s208     | 97.43              | 28          |
  | s510     | 99.14              | 57          |
  | s953     | 97.85              | 83          |
  | s1196    | 98.84              | 134         |
  | s1238    | 96.36              | 138         |
  | s5378    | 96.04              | 112         |
  | s9234    | 94.14              | 155         |
  | s15850   | 94.62              | 104         |
  | s35932   | 87.58              | 21          |
  | s38417   | 96.00              | 100         |
  | s38584   | 93.33              | 119         |

<p align="right">(<a href="#readme-top">back to t

## Revision History

- v2013 - Initial release<br>
- v2014 - Code modifications<br>
- v2023 - Code refactor for open source project<br>

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Authors

- Original Authors<br>
  \- <mark>Lin Hio-Ting</mark>, Hsu Po-Ya, Liao Kuan-Yu<br><br>
- v2013<br>
  \- Han Cheng-You, Chen Ching-Yu, Chiang Kuan-Ying, Wang Ying-Hsu, Chen Po-Hao, Lin Kuo-Yu, Pan Chun-Han, Li Chia-An, Tsai Chia-Ling, Hsu Ling-Yun<br><br>
- v2014<br>
  \- He Yu-Hao, Cai Zong-Yan, How Bo-Fan, Li Yu-Qing, Huang Guan-Yan, Xiao Zhi-Long, Lin Kun-Wei, Lin Shi-Yao, Chen You-Wei, Li Guan-De<br><br>
- v2023<br>
  \- Wang Wei-Shen, Chang Hsin-Tzu, Pan Yu-Hung, Liang Zhe-Jia<br><br>
- Advisor<br>
  \- <mark>Professor James Chien-Mo Li</mark>

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## References

- [1] <cite>Fujiwara and Shimono, "On the Acceleration of Test Generation Algorithms," in IEEE Transactions on Computers, vol. C-32, no. 12, pp. 1137-1144, Dec. 1983.</cite><br>
- [2] <cite>Brglez, Franc, David Bryan, and Krzysztof Kozminski. "Combinational profiles of sequential benchmark circuits." 1989 IEEE International Symposium on Circuits and Systems (ISCAS). IEEE, 1989.</cite><br>
- [3] Both `techlib/mod_nangate45.mdt` and `techlib/NangateOpenCellLibrary.v` are under `TECHLIB_LICENSE`<br>

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Contact
<address> Wang, Wei-Shen - b08901051@ntu.edu.tw</address>

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## License
Distributed under the MIT License. See `LICENSE` for more information.<br><br>

*Copyright (c) Laboratory of Dependable Systems (II), Graduate Institute of Electronics Engineering,  National Taiwan University, Taiwan. All Rights Reserved.*
<p align="right">(<a href="#readme-top">back to top</a>)</p>